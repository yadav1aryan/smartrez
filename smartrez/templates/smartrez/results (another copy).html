<head>
<title>Results for: {{query_name}}</title>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
<style>
.carousel-indicators li {
    background-color: #000000;
}
.carousel-indicators .active {
    background-color: #000000;
}
.carousel-caption h4,p {
    color: #000000;
}
.wrap {
 text-align: center;
}
</style>
</head>
{% load static %}
<h1>Results for: {{query_name}}</h1>
{% if error_message %}<p><strong>{{error_message}}</strong></p>{%endif%}
<div id="myCarousel" class ="carousel slide">
<ol class="carousel-indicators">
<li data-target="#myCarousel" data-slide-to="0" class="active" style="color: black;">
{% for choice in query.img_set.all|slice:"1:" %}
<li data-target ="#myCarousel" data-slide-to={{forloop.counter}} style="color: black;">
{% endfor %}
</ol>
	<div class="carousel-inner" style=" width:100%; height: 1000px !important;">
            		<div class ="item active">
				<img src="/smartrez{{MEDIA_URL}}{{query.img_set.all.0.img_path}}" style= "width: 50%; margin: auto;">
                                <div class="carousel-caption">
                                 <strong><h4>{{query.img_set.all.0.width}} x {{query.img_set.all.0.height}}</h4>
                                 <p>Previously used: {{query.img_set.all.0.usage_times}}</p></strong>
                                </div>
			</div>
		{% for choice in query.img_set.all|slice:"1:" %}
			<div class ="item">
				<img src="/smartrez{{MEDIA_URL}}{{choice.img_path}}"style= "width: 50%; margin: auto;">
                                <div class="carousel-caption">
                                 <strong><h4>{{choice.width}} x {{choice.height}}</h4>
                                 <p>Previously used: {{choice.usage_times}}</p></strong>
                                </div>
			</div>
		{% endfor %}
        </div>
  <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
    <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
    <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>

<form action="{% url 'smartrez:resize' query.term %}", method="post">
{% csrf_token %}
{% for choice in query.img_set.all %}
<input type="hidden" name="chosen{{forloop.counter}}" id="choice{{ forloop.counter }}" value = "{{choice.img_path}}"/>
{% endfor %}
<br><br>
<div class="wrap">
 <input type="hidden" name = "act_img" id="act_img" value="1" size="40"/>
 <input type="text" name = "width" placeholder="Width"/> x <input type="text" name = "height" placeholder="Height"/>
 <input type="submit" value="Resize" class="btn btn-info">
</div>
</form>
<script>
$(document).ready(function(){
    $("#myCarousel").carousel({
      interval: false
    })
    $("#myCarousel").on('slide.bs.carousel', function (e) {
     var slideFrom = $(this).find('.active').index();
     var slideTo = $(e.relatedTarget).index();
     console.log(slideFrom+' => '+slideTo);
     slideTo = slideTo +1
     $("#act_img").val(slideTo.toString());
    });
});
</script>
